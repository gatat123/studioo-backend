# 협업 시스템 기능 명세서

## 1. 시스템 개요

### 1.1 목적
크리에이티브 프로젝트를 위한 실시간 협업 플랫폼으로, 일러스트 및 스토리보드 작업의 효율적인 관리와 피드백 시스템을 제공

### 1.2 기술 스택
- **배포 환경**: Railway (Production)
- **데이터베이스**: PostgreSQL (Railway)
- **데이터 저장**: 실시간 자동 저장 및 영속성 보장
- **지원 이미지 포맷**: JPEG, PNG, WebP

---

## 2. Features & Functions (총 8개 주요 Feature)

### Feature 1: 인증 시스템 (Authentication System)

#### Functions:
1. **회원가입 (User Registration)**
   - 사용자 정보 입력 (아이디, 이메일, 비밀번호, 닉네임)
   - 이메일 형식 유효성 검증 (인증 시스템 제외)
   - 비밀번호 암호화 저장
   - 회원가입 완료 시 자동 스튜디오 생성
   - 스튜디오 페이지로 자동 리다이렉트

2. **로그인 (User Login)**
   - 아이디/비밀번호 인증
   - 세션 생성 및 관리
   - 로그인 성공 시 스튜디오 페이지로 이동
   - 자동 로그인 옵션 (선택사항)

3. **세션 관리 (Session Management)**
   - 세션 유지 및 갱신
   - 로그아웃 기능
   - 세션 만료 처리

---

### Feature 2: 스튜디오 관리 (Studio Management)

#### Functions:
1. **스튜디오 생성 (Studio Creation)**
   - 회원가입 시 자동 생성
   - 사용자별 고유 스튜디오 할당
   - 스튜디오 ID 생성 및 관리

2. **프로젝트 목록 표시 (Project List Display)**
   - 소유한 프로젝트 목록 표시
   - 참여 중인 프로젝트 목록 표시
   - 프로젝트 상태 표시 (진행중/완료/마감임박)
   - 태그별 필터링 (일러스트/스토리보드)

3. **알림 시스템 (Notification System)**
   - 프로젝트 업데이트 알림 아이콘 표시
   - 새 댓글 알림
   - 이미지 업로드 알림
   - 주석 요청 알림

---

### Feature 3: 프로젝트 관리 (Project Management)

#### Functions:
1. **프로젝트 생성 (Project Creation)**
   - 프로젝트 이름 입력
   - 프로젝트 설명 입력
   - 마감일 설정 (날짜 선택기)
   - 태그 설정 (일러스트/스토리보드)
   - 프로젝트 고유 ID 생성

2. **초대 시스템 (Invitation System)**
   - 초대 코드 자동 생성
   - 초대 코드 복사 기능
   - 초대 코드 입력을 통한 프로젝트 참여
   - 참여자 권한 관리

3. **프로젝트 삭제 (Project Deletion)**
   - 생성자만 삭제 권한 보유
   - 삭제 확인 다이얼로그
   - 관련 데이터 일괄 삭제

4. **프로젝트 관리 (Project Administration)**
   - 다중 프로젝트 생성 지원
   - 프로젝트 정보 수정
   - 참여자 목록 조회

---

### Feature 4: 씬 관리 (Scene Management)

#### Functions:
1. **씬 추가 (Scene Addition)**
   - 새 씬 생성
   - 씬 번호 자동 부여
   - 씬 탭 네비게이션

2. **이미지 업로드 (Image Upload)**
   - JPEG, PNG, WebP 포맷 지원
   - 선화/아트 구분 업로드
   - 드래그 앤 드롭 업로드
   - 파일 선택 업로드

3. **버전 관리 (Version Control)**
   - 이미지 업로드 히스토리 저장
   - 선화/아트 버전별 관리
   - 이전 버전 조회 및 선택
   - 버전 간 전환 기능

4. **씬 설명 (Scene Description)**
   - 씬별 설명 텍스트 입력
   - 연출 노트 작성
   - 실시간 자동 저장

---

### Feature 5: 협업 도구 (Collaboration Tools)

#### Functions:
1. **댓글 시스템 (Comment System)**
   - 프로젝트/씬별 댓글 작성
   - 댓글 스레드 관리
   - 실시간 댓글 업데이트
   - 댓글 작성자 표시
   - 타임스탬프 표시

2. **주석 기능 (Annotation Feature)**
   - 이미지 위 직접 주석 추가
   - 드로잉 도구 제공
   - 텍스트 주석 입력
   - 수정 요청 표시
   - 주석 저장 및 관리

3. **비교 모드 (Comparison Mode)**
   - 히스토리 이미지 드래그 앤 드롭
   - 나란히 보기
   - 오버레이 비교
   - 차이점 하이라이트

4. **이미지 뷰어 (Image Viewer)**
   - ImageZoomViewer 구현
   - 확대/축소 기능
   - 패닝 기능
   - 전체 화면 보기

---

### Feature 6: 사용자 프로필 (User Profile)

#### Functions:
1. **프로필 정보 수정 (Profile Edit)**
   - 닉네임 변경
   - 이메일 변경
   - 비밀번호 변경

2. **프로필 사진 (Profile Picture)**
   - 프로필 사진 업로드
   - 이미지 크롭 기능
   - 기본 아바타 제공

---

### Feature 7: 관리자 시스템 (Admin System)

#### Functions:
1. **전체 프로젝트 관리 (Global Project Management)**
   - 모든 프로젝트 목록 조회
   - 프로젝트 상세 정보 확인
   - 프로젝트 강제 삭제

2. **사용자 관리 (User Management)**
   - 전체 사용자 목록 조회
   - 사용자 정보 확인 (아이디, 닉네임, 이메일, 비밀번호 해시)
   - 사용자 계정 관리

3. **시스템 모니터링 (System Monitoring)**
   - 활성 프로젝트 통계
   - 사용자 활동 로그
   - 스토리지 사용량 모니터링

---

## 3. 데이터 요구사항

### 3.1 데이터 영속성
- 모든 입력 데이터는 실시간으로 PostgreSQL에 저장
- 세션 종료 후에도 데이터 유지
- 자동 저장 기능 구현 (디바운싱 적용)
- 실시간 협업 (WebSocket)

### 3.2 데이터베이스 스키마 주요 테이블
- **Users**: 사용자 정보
- **Studios**: 스튜디오 정보
- **Projects**: 프로젝트 정보
- **Scenes**: 씬 정보
- **Images**: 업로드된 이미지 및 히스토리
- **Comments**: 댓글 데이터
- **Annotations**: 주석 데이터
- **ProjectParticipants**: 프로젝트 참여자 관계

---

## 4. 보안 요구사항

### 4.1 인증 및 권한
- 비밀번호 해싱 (bcrypt 또는 유사)
- JWT 또는 세션 기반 인증
- 역할 기반 접근 제어 (RBAC)
  - 일반 사용자
  - 프로젝트 생성자
  - 관리자

### 4.2 데이터 보호
- HTTPS 통신
- SQL Injection 방지
- XSS 공격 방지
- CSRF 토큰 구현

---

## 5. 성능 요구사항

### 5.1 응답 시간
- 페이지 로딩: 3초 이내
- 이미지 업로드: 파일 크기에 따라 진행률 표시
- 실시간 저장: 500ms 이내

### 5.2 동시성
- 다중 사용자 동시 접속 지원
- 실시간 협업 시 충돌 방지
- 낙관적 락(Optimistic Locking) 구현

---

## 6. UI/UX 요구사항

### 6.1 반응형 디자인
- 데스크톱 우선 설계
- 태블릿 지원 고려

### 6.2 사용성
- 직관적인 네비게이션
- 드래그 앤 드롭 인터페이스
- 키보드 단축키 지원
- 실시간 피드백 (로딩 상태, 성공/실패 메시지)

---

## 7. 배포 및 운영

### 7.1 Railway 배포
- Production 환경 설정
- 환경 변수 관리
- PostgreSQL 연결 설정

### 7.2 모니터링
- 에러 로깅
- 성능 모니터링
- 사용자 활동 추적

---

## 8. 추후 확장 가능성

- 버전 관리 시스템 강화
- AI 기반 이미지 분석
- 모바일 앱 개발
- 외부 스토리지 연동 (AWS S3 등)
- 이메일 알림 시스템
- 프로젝트 템플릿 기능